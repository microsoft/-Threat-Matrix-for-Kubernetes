---
hide:
  - toc
  - footer
---

# Adhere to least-privilege principle

!!! info inline end
    ID: MS-M9003<br>
    MITRE mitigation: [M1018](https://attack.mitre.org/mitigations/M1018/)


Configure the Kubernetes role-based access controls (RBAC) for each user and service accounts to have only necessary permissions. This applies also to other, external, authorization providers such as Azure RBAC in AKS.

In managed cluster, Kubernetes credentials are often retrieved or generated by the cloud provider via API call. To reduce the attack surface, grant permissions to the cloud provider API only to necessary accounts. In the case of Azure, make sure that only required identities have permissions to call: `/subscriptions/resourceGroups/providers/Microsoft.ContainerService/managedClusters/listClusterUserCredential`

Kubeconfig file can contain credentials of accounts that allow interaction with a cluster. By applying least privileges principle to all accounts, can limit the impact of an account compromised through Kubeconfig file.

## Techniques Addressed by Mitigation

|ID|Name|Use|
|--|----------|-----------|
|[MS-TA9001](../techniques/Using%20Cloud%20Credentials.md)|Using Cloud Credentials|Limit RBAC privileges in the cloud account to retrieve access credentials to managed Kubenetes clusters.|
|[MS-TA9003](../techniques/Kubeconfig%20file.md)|Kubeconfig file|Limit privileges and actions that can be achieved by getting access to a kubeconfig file|
|[MS-TA9008](../techniques/New%20Container.md)|New Container|Prevent unnecessary users and service accounts from creating new pods and controllers.|
|[MS-TA9011](../techniques/Sidecar%20Injection.md)|Sidecar Injection|Prevent unnecessary users and service accounts from creating new pods and controllers.|
|[MS-TA9012](../techniques/Backdoor%20container.md)|Backdoor Container|Prevent unnecessary users and service accounts from creating new pods and controllers.|